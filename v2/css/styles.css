html {
    background-image: url("../img/background.webp");
    background-size: cover;
    background-repeat: no-repeat;
}

body,
html {
    height: 100%;
    margin: 0;
    font-family: sans-serif;
    overflow: hidden
}

#app {
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 30px;
    display: grid;
    place-items: center;
    text-align: center;
    position: absolute;
    top: 9%;
    left: 10%;
    right: 10%;
    bottom: 10%;
}


@keyframes jumpAndFlip {
    0% {
        transform: translateY(0) rotate(0deg);
        /* Start and end in the original position */
    }

    45% {
        transform: translateY(-15px) rotate(0deg);
        /* Start and end in the original position */
    }


    85% {
        transform: translateY(-15px) rotate(-360deg);
        /* Full backflip */
    }

    100% {
        transform: translateY(0) rotate(-360deg);
        /* Start and end in the original position */
    }
}

#loading {
    padding: 50px;
    overflow: visible;
    overflow-x: hidden;

}

#loading img {
    animation: jumpAndFlip 1.0s infinite;
    /* Adjust time as needed */
    animation-direction: normal;
    animation-fill-mode: forwards;

}

#app>h1 {
    text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.25), 1px 1px 1px rgb(255 255 255);
    margin-bottom: 0.5em;
    position: fixed;
    /* Changed from absolute to fixed if it should stay relative to viewport */
    top: 0;
    width: 80%;
    /* Ensure it doesn't overflow #app */
    left: 10%;
    /* Center it horizontally */
    right: 10%;
    text-align: center;
    /* Ensure text inside is centered */
    z-index: 5;
    /* Keep it above game container */
}



/* Combined stopGame and backToMain shared styles */
#stopGame,
.backToMain {
    background: #614ae2;
    padding: 0.5rem 1rem;
    font-size: 1.5rem;
    color: white;
    border: 2px solid white;
    border-radius: 10px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s, box-shadow 0.1s;
    text-shadow: 1px 1px 2px #000000bf;
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    user-select: none;
    top: 10%;
    left: 10%;
    z-index: 5;
    position: fixed;
}

.backToMain:hover {
    background-color: #4A90E2;
    transform: scale(1.05);
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
}

.backToMain:active {
    transform: scale(0.95);
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
}


h1,
h2,
h3 {
    font-family: 'Fredoka One', cursive;
    /* A playful yet neat font */
    color: #614ae2;
    text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.25);
    /* Subtle shadow for depth */
    margin-bottom: 0.5em;
    user-select: none;
    /* Prevent text selection */
}


#about p {
    font-family: 'Fredoka One', cursive;
    /* A playful yet neat font */
    font-weight: normal;
    font-size: 1.5rem;
}

h1 {
    font-size: 2.8rem;
    margin-top:0;
}

h2 {
    font-size: 2.5rem;
}

h3 {
    font-size: 2rem;
}


h1 small {
    display: block;
    font-size: 0.4em;
    color: #FFFFFF;
    text-shadow: 2px 2px 2px rgba(0, 0, 0, 0.25);
    font-weight: normal;
}

/* Keyframes for a gentle bounce effect */
@keyframes bounceIn {
    0% {
        transform: scale(0.8);
        opacity: 0.5;
    }

    70% {
        transform: scale(1.2);
        opacity: 1;
    }

    100% {
        transform: scale(1);
    }
}

/* Apply the bounceIn animation to the h1 tag within #app */
#app>h1 {
    /* Make selector more specific if needed */
    animation: bounceIn 1s ease-out forwards;
}


#gameContainer {
    width: 100%;
    max-width: 1200px;
    /* Constrain max width */
    height: 100%;
    /* Take full height of #app */
    margin: auto;
    padding: 20px;
    box-sizing: border-box;
    overflow-y: auto;
    /* Allow scrolling if content overflows */
    display: flex;
    /* Use flex to center its direct child (like mainMenu or gameArea) */
    flex-direction: column;
    /* Stack children vertically */
    align-items: center;
    /* Center children horizontally */
    justify-content: center;
    /* Center children vertically */
    padding-top: 50px;
    /* Add padding to avoid overlap with fixed h1 */
    view-transition-name: game-content; /* Give the container a transition name */
}


/* --- MODIFICATION START --- */
/* Apply common styles ONLY to containers that SHOULD be flex rows */
#sheetSelection,
#difficultySelection,
#highscores,
#endOfGameDialog,
#customQuestionsManager #customSheetSelection {
    margin-top: 20px;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background-color: rgb(154 147 147 / 40%);
    display: grid;
    position: relative;
    width: 100%;
    box-sizing: border-box;
}

/* Specific styles for #gameArea */
#gameArea {
    margin-top: 20px;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background-color: rgb(154 147 147 / 40%);
    display: block;
    position: relative;
    width: 90%;
    box-sizing: border-box;
    padding-bottom: 120px;
    overflow: hidden;
    height: calc(100% - 70px);
}

/* Added: Style #gameElements to be the main grid layout container */
#gameElements {
    display: grid;
    grid-template-columns: 1fr;             /* Single column */
    /* REMOVE grid rows for score/timer/question */
    /* grid-template-rows: auto auto 1fr; */ 
    /* Define rows ONLY for question(auto height) and answers(fill rest) */
    grid-template-rows: auto 1fr;           
    gap: 15px;                              /* Space between rows */
    height: calc(100% - 70px); /* Adjust height calculation if #gameHeader is variable */
    width: 100%;                           
    box-sizing: border-box;
    padding-top: 65px; /* Add padding to prevent overlap with fixed header items */
}

/* --- MODIFICATION END --- */


#endOfGameDialog {
    background-color: white;
    font-family: 'Fredoka One', cursive;
    padding: 20px;
    justify-items: center;
    text-align: center;
}

#endOfGameDialog .backToMain {
    position: absolute;
    /* Position relative to dialog */
    top: 15px;
    left: 15px;
}


#sheetSelection {
    grid-template-columns: 52% 38%;
    justify-content: space-around;
    align-items: start;
    padding-top: 50px;
    overflow-y: auto;
}

#sheetsCol {
    flex-basis: 52%;
    box-sizing: border-box;
    padding: 0 10px;
}

#difficultyCol {
    flex-basis: 38%;
    box-sizing: border-box;
    padding: 0 10px;
}

#difficultySelection {
    width: 100%;
}

#difficultySelection label {
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: center;
    margin-bottom: 10px;
    cursor: pointer;
    margin-left: 0;
    white-space: normal;
}

/* Fixed bottom bar for sheet selection START button */
#sheetNavigation {
    position: fixed;
    bottom: -100%;
    left: 10%;
    right: 10%;
    width: 80%;
    padding: 15px 0;
    background-color: rgba(97, 74, 226, 0.85);
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
    transition: bottom 0.4s ease-in-out;
    z-index: 15;
    display: grid;
    place-items: center;
    border-bottom-left-radius: 30px;
    border-bottom-right-radius: 30px;
}

#sheetNavigation.active {
        bottom: 0;
        width: 100%;
        left: 0;
        padding: 20px;
}

#startGame {
    width: 80%;
    padding: 1rem 2rem;
    font-size: 2rem;
    margin: 0;
    /* Remove margin */
    background: #FFD700;
    color: white;
    border: 2px solid white;
    border-radius: 15px;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000000bf;
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    outline: none;
    user-select: none;
    transition: transform 0.1s, box-shadow 0.1s;
}

#startGame:disabled {
    background: #aaa;
    cursor: not-allowed;
    box-shadow: none;
}

#startGame:not(:disabled):hover,
#startGame:not(:disabled):focus {
    transform: scale(1.05);
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
    background: linear-gradient(45deg, #FFC107, #FFEB3B);
}

#startGame:not(:disabled):active {
    transform: scale(0.95);
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
}


#playerName {
    font-size: 3rem;
    margin: 10px;
    border-radius: 10px;
    padding: 5px;
    font-family: 'Fredoka One', cursive;
    color: #614ae2;

}


#mainMenu {
    display: grid;
    place-items: center;
    width: 100%;
    /* Take full width of gameContainer */
}

#menuItems {
    display: grid;
    grid-auto-flow: row;
    justify-items: stretch;
    width: 90%;
    margin: 0 auto;
}

button {
    background: #FFD700;
    /* Golden color */
    color: white;
    border: 2px solid white;
    /* Base white border */
    border-radius: 15px;
    padding: 1.2rem 2rem;
    /* Adjusted padding */
    font-size: 2rem;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000000bf;
    /* Text shadow for depth */
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    /* Soft box shadow for 3D effect */
    transition: transform 0.1s, box-shadow 0.1s;
    margin: 0.75rem;
    /* Adjusted spacing */
    cursor: pointer;
    outline: none;
    /* Remove default focus outline */
    user-select: none;
    flex-grow: 0;
    /* Prevent buttons from growing unevenly */
}


button:hover,
button:focus {
    transform: scale(1.05);
    /* Slightly increase size on hover/focus */
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
    /* Larger shadow on hover/focus for lifting effect */
}

button:active {
    transform: scale(0.95);
    /* Slightly decrease size when clicked */
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
    /* Smaller shadow when clicked */
}

/* Gradient background example for hover state */
button:hover {
    background: linear-gradient(45deg, #FFC107, #FFEB3B);
}

/* This rule was overriding the gradient, remove or adjust */
/* button:hover {
    background-color: #45a049;
} */

/* Container for the scrollable list of sheets */
#sheetsCheckboxes {
    display: grid;
    gap: 5px;
    overflow-y: auto;
    padding: 10px;
    margin-bottom: 20px;
    width: 100%;
}

/* Custom style for the checkboxes */
input[type="checkbox"] {
    -webkit-appearance: none;
    appearance: none;
    margin: 0;
    width: 25px;
    height: 25px;
    background: white;
    border-radius: 5px;
    border: 2px solid #614ae2;
    position: relative;
    cursor: pointer;
    flex-shrink: 0;
    /* Prevent checkbox from shrinking */
    margin-right: 10px;
    /* Add space between checkbox and label text */
}

/* Style for checkbox when checked */
input[type="checkbox"]:checked {
    background: #614ae2;
    border-radius: 5px;
}

/* Custom checkmark style */
input[type="checkbox"]:checked:after {
    content: 'âœ“';
    position: absolute;
    top: 0px;
    /* Adjust position */
    left: 5px;
    /* Adjust position */
    font-size: 18px;
    color: white;
}

/* Style for labels */
label {
    font-family: 'Fredoka One', cursive;
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: center;
    font-size: 1.5rem;
    line-height: 2rem;
    color: #614ae2;
    white-space: normal;
    cursor: pointer;
    user-select: none;
    transition: color 0.3s ease;
    padding: 5px 0;
}

label:hover {
    color: #4A90E2;
    /* Lighter shade when hovering over label */
}

/* Remove ::before pseudo-element if not needed or used */
/* label::before { ... } */


/* --- QUESTION STYLING (Inside #gameArea / #gameElements) --- */
#question {
    color: #000000;
    text-shadow: none;
    font-size: 3rem;
    font-weight: bold;
    text-align: center;
    box-sizing: border-box;
    width: 100%;
    padding: 10px 0;
    /* Position within the #gameElements grid */
    grid-row: 1;
    grid-column: 1;
    align-self: center;
}

/* --- ANSWERS STYLING (Inside #gameArea / #gameElements) --- */
/* Ensure the intermediate answerGrid fills its parent grid cell */
#answerGrid {
    grid-row: 2;    /* Place in the 2nd row of #gameElements grid */
    grid-column: 1;
    height: 100%;   /* Fill the vertical space of its grid cell */
    min-height: 0;
    /* overflow: hidden; /* Removed */
}

#answers {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-auto-rows: 1fr;
    gap: 15px;
    width: 100%;
    box-sizing: border-box;
    height: 100%; /* Fill the now-stretching #answerGrid */
    /* Position within the #gameElements grid */
    grid-row: 2; /* Place in the SECOND row of the updated grid */
    grid-column: 1;
}

#answers button {
    box-sizing: border-box;
    text-align: center;
    padding: 20px;
    font-size: 2.5rem;
    background: #FFD700;
    color: white;
    border: 2px solid white;
    border-radius: 15px;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000000bf;
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    transition: transform 0.1s, box-shadow 0.1s, background-color 0.2s ease-out;
    cursor: pointer;
    outline: none;
    user-select: none;
    margin: 0;
    width: 100%;
    height: 100%;
    min-height: 0; /* Added: Prevent minimum size issues */
}

#answers button:not(:disabled):hover,
#answers button:not(:disabled):focus {
    transform: scale(1.05);
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
    /* Remove the background gradient here, as it will be overridden by correct/wrong states anyway */
    /* background: linear-gradient(45deg, #FFC107, #FFEB3B); */
}

#answers button:not(:disabled):active {
    transform: scale(0.95);
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
}

#answers button:disabled {
    background-color: #b0b0b0;
    color: #e0e0e0;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    border-color: #999;
}

/* --- TIMER & SCORE STYLING --- */
#timer,
#score {
    font-size: 2.5rem;
    /* Slightly smaller */
    margin: 10px 0;
    /* Reduced margin */
    position: fixed;
    /* Keep fixed */
    font-family: 'Fredoka One', cursive;
    color: #614ae2;
    text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.25);
    right: 12%;
    /* Adjusted position */
    z-index: 10;
    /* Above game area */
}

#score {
    top: 11%;
    /* Adjusted position */
}

#timer {
    top: 17%;
    /* Adjusted position */
}

/* General Checkbox size override (if needed, check specificity) */
/* input[type=checkbox] {
    height: 2rem;
    width: 2rem;
    margin-right:1rem;
} */

.disable-interaction {
    pointer-events: none;
}

@keyframes drop {
    0% {
        transform: translateY(-100%);
        opacity: 1;
    }

    100% {
        transform: translateY(100vh);
        opacity: 0;
    }
}

.emoji-fall {
    position: fixed;
    top: 0;
    left: 50%;
    font-size: 5rem;
    opacity: 0;
    /* Start fully transparent */
    animation: drop 1.5s linear forwards;
    /* Start the drop animation */
    pointer-events: none;
    /* Ensure the emoji doesn't interfere with clicks */
    z-index: 20;
    /* Ensure the emoji is visible above other content */
}

#exitGame {
    position: fixed;
    /* Keep fixed */
    top: 11%;
    left: 11%;
    z-index: 10;
    /* Ensure it's above game area */
}


#highscores {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    text-align: center;
    background-color: rgb(154 147 147 / 40%);
    max-height: 80%;
    overflow-y: auto;
}

#highscores h1 {
    color: #614ae2;
    margin-bottom: 1rem;
    font-size: 2rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}


#highscores .score-container.top-score {
    background: #ffd700;
    font-weight: bold;
}

.score-name,
.score-score,
.score-timestamp {
    flex: 1;
    padding: 0 5px;
}

#highscores table {
    font-size: 1.2rem;
    /* Slightly smaller font */
    width: 100%;
    /* Table takes full width */
}

/* Additional styling for top scores */
#highscores .top-score .score-name,
#highscores .top-score .score-score,
#highscores .top-score .score-timestamp {
    color: #604ae0;
    /* White text for better contrast on gold background */
}

th.score-rank {
    padding: 2px;
    font-size: 1.5rem;
}


/* Gold background for the first place */
#highscores tr.top-score:nth-child(1) {
    background: #ffd700;
    /* Solid gold color */
}

/* Gradient background for the second place */
#highscores tr.top-score:nth-child(2) {
    background: linear-gradient(to right, #e6c300, #fff9e6);
    /* Adjusted gold */
}

/* Gradient background for the third place */
#highscores tr.top-score:nth-child(3) {
    background: linear-gradient(to right, #cca700, #fff);
    /* Darker gold fade */
}

table {
    margin: 20px 0;
    /* max-height: 300px; /* Removed, rely on #highscores overflow */
    background: #ececff;
    /* overflow-y: auto; /* Removed, rely on #highscores overflow */
    text-align: left;
    border-collapse: collapse;
    border-radius: 10px;
    /* Rounded corners for table */
    overflow: hidden;
    /* Clip content to rounded corners */
    width: 100%;
    /* Ensure table takes width */

    padding: 0;
    /* Remove padding from table itself */
    margin-bottom: 10px;
    box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);

}

th {
    text-align: center;
    padding: 10px;
    background-color: #dcd6ff;
    /* Header background */
}

#scoreList tr:nth-child(even) {
    background-color: #f7f5ff;
    /* Zebra striping */
}

#scoreList td {
    padding: 8px 10px;
    /* Adjust cell padding */
}


/* Back button is already styled above */

@keyframes wiggle {

    0%,
    100% {
        transform: rotate(-3deg);
    }

    50% {
        transform: rotate(3deg);
    }
}

/* Apply correct answer style regardless of hover/active state */
#answers button.correct-answer,
#answers button.correct-answer:hover,
#answers button.correct-answer:focus,
#answers button.correct-answer:active {
    animation: wiggle 0.2s ease-in-out;
    background: rgba(82, 226, 74, 0.85); /* Use the slightly darker hover shade consistently */
    border-color: #3a8a35;
    color: white;
    /* Ensure transform/shadow don't revert completely on active */
    transform: scale(1); 
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
}

/* Apply wrong answer style regardless of hover/active state */
#answers button.wrong-answer,
#answers button.wrong-answer:hover,
#answers button.wrong-answer:focus,
#answers button.wrong-answer:active {
    background: rgba(226, 74, 74, 0.85); /* Use the slightly darker hover shade consistently */
    border-color: #a03232;
    color: white;
    /* Ensure transform/shadow don't revert completely on active */
    transform: scale(1); 
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
}

/* Remove the now redundant specific hover rules */
/* 
#answers button.correct-answer:hover {
    background: rgba(82, 226, 74, 0.85);
}

#answers button.wrong-answer:hover {
    background: rgba(226, 74, 74, 0.85);
}
*/

.wip {
    color: red;
    font-family: 'Fredoka One';
    font-size: 5rem;
    position: fixed;
    rotate: -56deg;
    background-color: rgba(255, 224, 224, 0.8);
    padding: 100px;
    border-radius: 100px;
    z-index: 100;
    /* Ensure it's on top */
}

#about {
    display: grid;
    text-align: left;
    width: 90%;
    max-height: 80%;
    overflow-y: auto;
    background-color: rgb(154 147 147 / 40%);
    padding: 30px;
    border-radius: 20px;
    box-sizing: border-box;
}

#customQuestionsManager {
    position: absolute;
    top: 9%;
    left: 10%;
    right: 10%;
    bottom: 10%;
    border-radius: 30px;
    display: grid;
    justify-items: center;
    align-content: start;
    text-align: center;
    overflow-y: auto;
    background-color: rgb(154 147 147 / 40%);
    padding: 20px;
    box-sizing: border-box;
}

#customQuestionsManager h2 {
    /* Target h2 instead of h1 if h1 is fixed */
    text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.25), 1px 1px 1px rgb(255 255 255);
    margin-bottom: 1em;
    /* Increased margin */
    color: #614ae2;
    font-size: 2.5rem;
    /* Adjusted size */
}

#customQuestionsManager #customSheetSelection {
    grid-template-columns: 60% 35%;
    justify-content: space-between;
    width: 100%;
    padding: 20px 0;
    box-sizing: border-box;
    background-color: transparent;
    box-shadow: none;
    margin-top: 0;
    border-radius: 0;
}

#customSheetsCol {
    width: 60%;
}

#customDifficultyCol {
    width: 35%;
}

#customQuestionsInput {
    display: grid;
    gap: 10px;
}

#customQuestionsInput input[type="text"],
#customQuestionsTextarea {
    width: 100%;
    padding: 10px;
    border: 2px solid #614ae2;
    border-radius: 10px;
    font-size: 16px;
    box-sizing: border-box;
}

#customQuestionsTextarea {
    min-height: 200px;
    resize: vertical;
}

#customDifficultySelection {
    display: grid;
    gap: 10px;
}

#customDifficultySelection button,
#customDifficultySelection select {
    width: 100%;
    margin-bottom: 10px;
    padding: 0.75rem 1rem;
    /* Consistent padding */
    font-size: 1.2rem;
    /* Consistent font size */
}

/* Add the custom color for the delete button */
#deleteCustomQuestionsButton {
    background: linear-gradient(45deg, #ff4d4d, #ff6666);
}

#connectionCodeInput {
    margin-top: 20px;
    display: grid;
    justify-items: center;
    gap: 10px;
}

#connectionCodeInput input {
    font-size: 2rem;
    padding: 10px;
    width: 200px;
    text-align: center;
    text-transform: uppercase;
    border: 2px solid #614ae2;
    border-radius: 5px;
}

#connectionCodeInput button {
    font-size: 1.5rem;
    padding: 10px 20px;
    background-color: #614ae2;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#connectionCodeInput button:hover {
    background-color: #4A90E2;
}

#connectionCode h3 {
    font-size: 3rem;
    color: #614ae2;
    text-align: center;
    margin: 20px 0;
    font-family: 'Fredoka One', cursive;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

#waitingMessage {
    font-size: 1.5rem;
    color: #614ae2;
    text-align: center;
    margin: 20px 0;
    font-family: 'Fredoka One', cursive;
}

#multiplayerChoice {
    display: grid;
    justify-items: center;
    gap: 20px;
    padding: 30px;
    background-color: rgb(154 147 147 / 40%);
    border-radius: 30px;
    width: 90%;
    max-width: 600px;
    margin: 0 auto;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    box-sizing: border-box;
}

#multiplayerChoice h2 {
    font-size: 3rem;
    color: #614ae2;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}

.name-input-container {
    display: grid;
    justify-items: center;
    width: 100%;
    margin-bottom: 20px;
}

.name-input-container label {
    font-size: 2rem;
    color: #614ae2;
    margin-left: 0;
    margin-bottom: 10px;
    display: block;
    /* Ensure label is block */
    text-align: center;
    /* Center label text */
}

.name-input-container input[type="text"] {
    width: 80%;
    max-width: 400px;
    font-size: 1.5rem;
    padding: 10px 15px;
    border: 3px solid #614ae2;
    border-radius: 15px;
    text-align: center;
    font-family: 'Fredoka One', cursive;
    background-color: white;
    /* Ensure white background */
}

#multiplayerChoice button.menuButton {
    /* General button style applied earlier */
    width: 80%;
    background: linear-gradient(45deg, #FFC107, #FFEB3B);
    border: 3px solid white;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    margin: 10px auto;
    /* Use auto margin for centering if needed */
    padding: 20px;
    font-size: 1.8rem;
}

#connectionStatus {
    display: grid;
    justify-items: center;
    gap: 20px;
    padding: 20px;
    width: 90%;
    max-width: 600px;
    box-sizing: border-box;
}

.connectionBox {
    background: rgba(255, 255, 255, 0.9);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 100%;
    /* Take full width of parent */
    margin: 0 auto;
    box-sizing: border-box;
}

.input-wrapper {
    display: grid;
    gap: 15px;
    justify-items: center;
}

#connectionStatus #connectionCodeInput {
    /* Target the specific input */
    font-size: 2.5rem;
    padding: 15px;
    width: 90%;
    /* Adjust width */
    text-align: center;
    text-transform: uppercase;
    border: 3px solid #614ae2;
    border-radius: 10px;
    font-family: 'Fredoka One', cursive;
    color: #614ae2;
    background: white;
    margin: 0 auto;
    display: block;
    box-sizing: border-box;
}

#connectionStatus #connectionCodeInput::placeholder {
    color: #614ae280;
    font-size: 1.8rem;
}

.help-text {
    color: #614ae2;
    font-family: 'Fredoka One', cursive;
    font-size: 1.5rem;
    margin-top: 20px;
    text-align: center;
}

.waitingText {
    color: #614ae2;
    font-family: 'Fredoka One', cursive;
    font-size: 2rem;
    text-align: center;
    margin-top: 20px;
}

.yellow-button {
    /* Already styled by general button rules */
    background: #FFD700;
    width: 80%;
    margin-top: 10px;
}

/* WebRTC Debug Styles */
.debugBox {
    background: rgba(0, 0, 0, 0.7);
    color: #00ff00;
    font-family: monospace;
    padding: 15px;
    border-radius: 5px;
    margin-top: 20px;
    width: 100%;
    max-width: 600px;
    text-align: left;
    box-sizing: border-box;
}

.debugBox h3 {
    color: #fff;
    font-size: 1.2rem;
    margin-bottom: 10px;
    text-shadow: none;
}

.debugLog {
    height: 150px;
    overflow-y: auto;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 3px;
    font-size: 0.9rem;
    line-height: 1.4;
}

.debugLog .error {
    color: #ff4d4d;
}

.debugLog .success {
    color: #4dff4d;
}

.debugLog .info {
    color: #4dbbff;
}

/* Multiplayer Game Styles */
#multiplayerGame #answers {
    /* Target specific multiplayer answers */
    display: grid;
    gap: 15px;
    margin: 20px 0;
    justify-items: center;
}

#multiplayerGame #answers button {
    flex: none;
    /* Don't allow flex grow/shrink */
    width: 80%;
    /* Set a fixed width */
    max-width: 400px;
    /* Max width */
    margin: 0 auto;
    /* Center button */
    padding: 20px;
    font-size: 2rem;
}

/* Winner announcement styles */
.unicorn-theme {
    /* General dialog theme */
    background: linear-gradient(45deg, #ff6b6b, #ff9f43, #feca57, #2ecc71);
    border: 3px solid #ffffff;
    border-radius: 20px;
    text-align: center;
    position: relative;
    overflow: visible;
    padding: 30px;
    /* Add padding */
    color: white;
    /* Default text color */
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
    /* Add subtle shadow */
}

.unicorn-theme h1,
.unicorn-theme h2 {
    color: white;
    /* Ensure headers are white */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.player-result {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 15px;
    margin: 20px auto;
    padding: 15px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 15px;
    color: #333;
    text-shadow: none;
    width: 90%;
    max-width: 400px;
    box-sizing: border-box;
}

.player-result.winner {
    transform: scale(1.05);
    background: #ffeaa7;
    animation: glow 1s infinite alternate;
    color: #614ae2;
    font-weight: bold;
}

.player-emoji {
    grid-column: 1;
    font-size: 3em;
}

.player-name {
    text-align: left;
}

.score-badge {
    grid-column: 3;
    display: inline-grid;
    justify-items: center;
    gap: 2px;
    background: #2ecc71;
    color: white;
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9rem;
    text-shadow: none;
}

.score-badge .score-label {
    font-size: 0.8em;
    margin-bottom: 2px;
}

.score-badge .score-value {
    font-size: 1.2em;
    font-weight: bold;
}

@keyframes glow {
    from {
        box-shadow: 0 0 10px #ff9f43;
    }

    to {
        box-shadow: 0 0 20px #ff9f43, 0 0 30px #ff9f43;
    }
}

.winner::after {
    content: "ðŸŽ‰";
    font-size: 3em;
    position: absolute;
    top: -20px;
    left: calc(50% - 0.5em);
    animation: float 3s ease-in-out infinite;
    z-index: -1;
}

@keyframes float {
    0% {
        transform: translateY(0) rotate(0deg);
    }

    50% {
        transform: translateY(-20px) rotate(180deg);
    }

    100% {
        transform: translateY(0) rotate(360deg);
    }
}


/* Multiplayer Name Input was handled earlier */

/* Question progress indicator */
#playerScores {
    grid-row: 1;
    grid-column: 1;
    width: 100%;
    display: grid;
    grid-auto-flow: column;
    justify-content: space-between;
    align-items: center;
    gap: 5px;
    padding: 5px 10px;
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 15px;
    margin-bottom: 0;
    box-sizing: border-box;
}

.player-score-display {
    font-family: 'Fredoka One', cursive;
    font-size: 1.2rem;
    color: #614ae2;
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
    padding: 5px 10px;
    text-align: center;
}

#progressIndicator {
    grid-column: 2; 
    margin: 0 auto; 
    width: auto; 
    position: relative;
    top: auto; right: auto; 
    /* *** REVERT/ADJUST FONT & PADDING *** */
    font-size: 1.2rem; /* Restore or adjust size */
    padding: 8px 15px; /* Restore or adjust padding */
    /* Keep existing styles for background, color, radius etc. */
    background-color: rgba(97, 74, 226, 0.7);
    color: white;
    border-radius: 20px;
    font-weight: bold;
    font-family: 'Fredoka One', cursive;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    display: inline-flex; /* Use flex to align text and bar */
    align-items: center; /* Vertically center text and bar */
    gap: 8px; /* Add gap between text and bar */
}
#progressIndicator progress { 
    height: 12px; 
    vertical-align: middle; 
    appearance: none; 
    border: 1px solid rgba(0,0,0,0.2); /* Add subtle border */
    border-radius: 10px;
    overflow: hidden;
    background-color: rgba(255, 255, 255, 0.3); /* Ensure background color for track */
    width: 150px; /* Give it a minimum width */
}
/* Styling for the progress bar value (track) */
#progressIndicator progress::-webkit-progress-bar {
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 10px;
}
#progressIndicator progress::-webkit-progress-value {
    background-color: white;
    border-radius: 10px;
     /* Add a subtle transition */
    transition: width 0.3s ease-out;
}
#progressIndicator progress::-moz-progress-bar { /* Firefox */
     background-color: white;
     border-radius: 10px;
     transition: width 0.3s ease-out; /* Add transition for FF */
}

/* Animation for opponent score updates */
@keyframes scoreUpdate {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
        background-color: #FFD700;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        color: white;
        border-radius: 10px;
    }

    100% {
        transform: scale(1);
    }
}

/* Class to apply the animation */
.score-updated {
    animation: scoreUpdate 0.6s ease-in-out;
}


.hidden {
    display: none !important;
    /* This class controls the visibility */
}

/* --- GAME NAVIGATION BAR (Fixed Bottom) --- */
#gameNavigation {
    position: fixed;
    bottom: -100%;
    left: 0%;
    right: 0%;
    width: 100%;
    background-color: rgba(97, 74, 226, 0.85);
    transition: bottom 0.5s ease-in-out;
    z-index: 15;
    display: grid;
    place-items: center;
    padding: 15px 0;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
    margin-top: 0;
    border-bottom-left-radius: 30px;
    border-bottom-right-radius: 30px;
}

#gameNavigation.active {
    bottom: 0%;
    /* Align with bottom of #app */
}

/* Style the #nextButton specifically for the bottom bar */
#gameNavigation #nextButton {
    width: 80%;
    padding: 1rem 2rem;
    font-size: 2rem;
    margin: 0;
    background: #FFD700;
    color: white;
    border: 2px solid white;
    border-radius: 15px;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000000bf;
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    outline: none;
    user-select: none;
    transition: transform 0.1s, box-shadow 0.1s, background-color 0.1s;
    box-sizing: border-box;
    text-align: center;
}

#gameNavigation #nextButton:disabled {
    background: #aaa;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
}

#gameNavigation #nextButton:not(:disabled):hover,
#gameNavigation #nextButton:not(:disabled):focus {
    transform: scale(1.05);
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
    background: linear-gradient(45deg, #FFC107, #FFEB3B);
}

#gameNavigation #nextButton:not(:disabled):active {
    transform: scale(0.95);
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    h1 {
        font-size: 2.5rem;
    }

    h2 {
        font-size: 2rem;
    }

    h3 {
        font-size: 1.8rem;
    }

    button {
        font-size: 1.5rem;
        padding: 1rem 1.5rem;
        margin: 0.5rem;
    }

    #answers button {
        font-size: 1.8rem;
        padding: 15px;
        min-height: 80px;
    }

    #question {
        font-size: 2rem;
    }

    #timer,
    #score {
        font-size: 1.8rem;
    }

    #gameNavigation #nextButton {
        font-size: 1.5rem;
        padding: 0.8rem 1.5rem;
    }

    #sheetNavigation #startGame {
        font-size: 1.5rem;
        padding: 0.8rem 1.5rem;
    }

    .backToMain,
    #stopGame {
        font-size: 1.2rem;
        padding: 0.4rem 0.8rem;
    }

    #app {
        top: 5%;
        left: 5%;
        right: 5%;
        bottom: 5%;
        border-radius: 20px;
    }

    #gameNavigation,
    #sheetNavigation {
        left: 5%;
        right: 5%;
        width: 90%;
        bottom: 5%;
        border-radius: 0;
        border-bottom-left-radius: 20px;
        border-bottom-right-radius: 20px;
    }

    #gameArea {
        width: 100%;
        padding: 15px;
        padding-bottom: 100px;
    }

    /* Adjust padding */
    #answers {
        gap: 10px;

    }

    #playerScores {
        flex-direction: column;
        gap: 5px;
    }

    #progressIndicator {
        order: -1;
        /* Put progress on top on mobile */
    }

    .player-score-display {
        font-size: 1rem;
        padding: 3px 8px;
    }
}

@media (max-width: 480px) {
    h1 {
        font-size: 2rem;
    }

    #app>h1 small {
        font-size: 0.5em;
    }

    button {
        font-size: 1.2rem;
        padding: 0.8rem 1rem;
    }

    #answers button {
        font-size: 1.5rem;
        padding: 10px;
        min-height: 60px;
    }

    #question {
        font-size: 1.8rem;
    }

    label {
        font-size: 1.2rem;
    }

    #timer,
    #score {
        font-size: 1.5rem;
    }

    #gameNavigation #nextButton,
    #sheetNavigation #startGame {
        font-size: 1.2rem;
        padding: 0.6rem 1rem;
    }

    #answers button {
        flex-basis: 100%;
    }

    /* Stack answers vertically */

}

/* Enhanced Host Code Display */
.host-code-wrapper {
    display: grid;
    grid-auto-flow: column;
    align-items: center;
    justify-content: center;
    margin-top: 10px;
    margin-bottom: 20px;
    gap: 10px;
}

.host-code-text {
    font-family: 'Fredoka One', cursive;
    font-size: 0.8rem; /* Reduced font size slightly */
    font-weight: bold;
    color: #614ae2; /* Use theme colors? Maybe keep specific for contrast */
    letter-spacing: 1px; /* Reduced letter spacing */
    background-color: rgba(255, 255, 255, 0.8); /* Lighter background inside dialog */
    padding: 10px 15px; /* Adjusted padding */
    border-radius: 10px;
    border: 2px dashed #614ae2;
    margin-right: 15px; /* Keep some space before buttons */
    line-height: 1.4; /* Added line-height for wrapping */
    text-align: left; /* Align text left for better readability when wrapped */
    overflow-wrap: break-word; /* Allow breaking long words/URLs */
    word-break: break-all; /* Force breaks if needed */
    /* Remove fixed width if it was previously set */
}

/* Optional: Add specific style if only the link needs breaking */
.join-link-text {
    letter-spacing: normal; /* Reset letter spacing for better URL readability */
    /* word-break: break-all; /* Already applied to host-code-text, but could be specific here */
}

.copy-button {
    background: #614ae2;
    border: none;
    border-radius: 50%;
    padding: 10px;
    cursor: pointer;
    display: inline-grid;
    place-items: center;
    transition: background-color 0.2s ease, transform 0.1s ease;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
}

.copy-button:hover {
    background-color: #4A90E2;
    transform: scale(1.1);
}

.copy-button:active {
    transform: scale(0.95);
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
}

.copy-button svg {
    /* SVG styles are inline, but can override size here if needed */
    width: 24px;
    height: 24px;
}

/* General Share Button Style */
.share-button {
    background: #614ae2;
    border: none;
    border-radius: 50%;
    padding: 10px;
    cursor: pointer;
    display: inline-grid;
    place-items: center;
    transition: background-color 0.2s ease, transform 0.1s ease;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    text-decoration: none;
}

.share-button:hover {
    transform: scale(1.1);
}

.share-button:active {
    transform: scale(0.95);
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
}

.share-button svg {
    width: 24px;
    height: 24px;
    fill: #FFFFFF; /* Ensure icon is white */
}

/* WhatsApp Specific Style */
.whatsapp-button {
    background-color: #25D366; /* WhatsApp green */
}

.whatsapp-button:hover {
    background-color: #1DAE54; /* Darker WhatsApp green */
}

/* Kirby Waiting Animation */
.waiting-kirby {
    display: block; /* Center it */
    margin: 20px auto; /* Space around it */
    width: 100px; /* Adjust size as needed */
    height: auto;
    /* Apply the jumpAndFlip animation from loading screen */
    animation: jumpAndFlip 1.0s infinite; 
    animation-direction: normal;
    animation-fill-mode: forwards;
}

/* Waiting Message Animation */
#connectionCode .waitingText { /* Target waiting text specifically inside connectionCode box */
    font-size: 1.5rem;
    color: #614ae2;
    text-align: center;
    margin: 15px 0 10px 0; /* Adjust margin */
    font-family: 'Fredoka One', cursive;
}

@keyframes blink { 
    0% { opacity: 0; } 
    50% { opacity: 1; } 
    100% { opacity: 0; } 
}

#waitingMessage span[class^="dot"] { 
    animation: blink 1.4s infinite; 
    opacity: 0; 
}

#waitingMessage .dot1 { animation-delay: 0s; } 
#waitingMessage .dot2 { animation-delay: 0.2s; } 
#waitingMessage .dot3 { animation-delay: 0.4s; } 


/* Adjust h2 positioning for Dialog */
#connectionStatus h2 {
    margin-top: 10px; /* Reduce top margin */
    margin-bottom: 20px;
    color: #FFFFFF; /* White text for unicorn theme */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Consistent shadow */
    font-size: 2.5rem;
}

/* Remove background/shadow from inner boxes when inside dialog */
#connectionStatus .connectionBox {
    background: transparent;
    padding: 15px 0; /* Adjust padding */
    box-shadow: none;
    width: 90%; /* Adjust width as needed */
    max-width: 500px; /* Optional max width */
    margin: 0 auto;
    box-sizing: border-box;
    display: flex; /* Use flex for centering inner content */
    flex-direction: column;
    align-items: center;
}

/* Ensure input/button inside joinView still look ok */
#connectionStatus #joinView .input-wrapper {
    background-color: rgba(255, 255, 255, 0.8); /* Light background for contrast */
    padding: 20px;
    border-radius: 10px;
    width: 100%;
    box-sizing: border-box;
}

#connectionStatus #joinView .input-wrapper input {
    /* Styles likely ok, but ensure contrast */
    background-color: white; 
}

#connectionStatus #joinView .input-wrapper .help-text {
    color: #614ae2; /* Ensure readable color */
    text-shadow: none;
}

/* Ensure help text inside host view is readable */
#connectionStatus #connectionCode .help-text {
    color: white; 
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4); 
    font-size: 1.2rem;
    margin-bottom: 10px;
}

/* --- Waiting UI (Inside #gameArea) --- */
#waitingUi {
    display: grid;
    place-items: center;
    text-align: center;
    padding: 40px;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
}

#waitingMessageText {
    font-family: 'Fredoka One', cursive;
    font-size: 2rem;
    color: #614ae2;
    margin-bottom: 30px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

/* Add styles for .waiting-kirby if you use it */
.waiting-kirby {
    width: 80px; /* Adjust size */
    height: auto;
    margin-bottom: 20px;
    animation: jumpAndFlip 1.0s infinite;
}


/* --- Opponent List Styling --- */
#opponentList {
    position: fixed;
    top: 25%;
    left: 12%;
    width: auto;
    max-height: 50%;
    overflow-y: auto;
    background-color: rgba(255, 255, 255, 0.4);
    border-radius: 10px;
    padding: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 8;
    display: grid;
    gap: 8px;
}

.opponent-entry {
    display: grid;
    grid-template-columns: 1fr auto auto;
    align-items: center;
    gap: 10px;
    padding: 5px 10px;
    background-color: rgba(255, 255, 255, 0.6);
    border-radius: 5px;
    font-family: 'Fredoka One', cursive;
    font-size: 1rem;
    color: #333;
}

.opponent-entry.local-player {
    background-color: rgba(97, 74, 226, 0.3); /* Highlight self */
    font-weight: bold;
    color: #614ae2;
}

.opponent-entry .opponent-name {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.opponent-entry .opponent-score {
    font-weight: bold;
    color: #614ae2;
}
.opponent-entry .opponent-status {
    font-size: 0.8em;
    color: #555;
    font-style: italic;
}

/* Style for finished opponents */
.opponent-entry.finished {
    opacity: 0.7;
    background-color: rgba(200, 200, 200, 0.5);
}
.opponent-entry.finished .opponent-name,
.opponent-entry.finished .opponent-score {
    text-decoration: line-through;
    color: #666;
}


/* --- Multiplayer End Dialog Styles --- */
#multiplayerEndDialog {
    border: 3px solid #ffffff;
    border-radius: 20px;
    text-align: center;
    padding: 30px;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
    width: 80%;
    max-width: 700px; /* Adjust max width */
    background: linear-gradient(135deg, #614ae2, #9b59b6, #f39c12); /* Example gradient */
    box-sizing: border-box;
}

#multiplayerEndDialog::backdrop {
    background-color: rgba(0, 0, 0, 0.6);
}


#multiplayerEndDialog h2 { /* Target the title */
    color: white;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    font-size: 2.8rem;
    margin-bottom: 25px;
}

#multiplayerEndResults {
    margin-bottom: 30px; /* Space above button */
    max-height: 40vh; /* Limit height of results list */
    overflow-y: auto; /* Allow scrolling if many players */
    padding: 0 10px; /* Padding inside scroll area */
}

.player-result {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 15px;
    margin: 20px auto;
    padding: 15px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 15px;
    color: #333;
    text-shadow: none;
    width: 95%;
    box-sizing: border-box;
    font-family: 'Fredoka One', cursive;
    font-size: 1.3rem;
}

.player-result.winner {
    background: #ffd700;
    color: #614ae2;
    font-weight: bold;
    transform: scale(1.05);
    box-shadow: 0 0 10px #ffc107;
}

.player-result .player-rank {
    grid-column: 1;
    font-weight: bold;
    color: #888;
}
.player-result.winner .player-rank {
    color: #614ae2;
}

.player-result .player-name {
    grid-column: 2;
    text-align: left;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.player-result .player-final-score {
    grid-column: 3;
    font-weight: bold;
    color: #614ae2;
}

#multiplayerEndDialog button {
    background: #FFD700;
    padding: 1rem 2rem;
    font-size: 1.5rem;
    margin-top: 20px;
}

/* View Transition Animations */

::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: 0.5s; /* Adjust overall duration if needed */
  animation-timing-function: ease-out; /* Smoother exit/entry */
}

/* Define the keyframes for the animations (Keep these) */
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes slideInFromTop {
  from { transform: translateY(-100%); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}

@keyframes slideOutToBottom {
  from { transform: translateY(0); opacity: 1; }
  to   { transform: translateY(100%); opacity: 0; }
}

/* NEW: Animations for 'back' navigation */
@keyframes slideInFromLeft {
  from { transform: translateX(-100%); opacity: 0; }
  to   { transform: translateX(0); opacity: 1; }
}

@keyframes slideOutToRight {
  from { transform: translateX(0); opacity: 1; }
  to   { transform: translateX(100%); opacity: 0; }
}

/* Apply animations based on temporary CLASS on HTML element */
/* Forward */
html.transitioning-forward::view-transition-old(main-content),
html.transitioning-forward::view-transition-old(sheets-column),
html.transitioning-forward::view-transition-old(difficulty-column) {
  animation-name: slideOutToBottom;
}
html.transitioning-forward::view-transition-new(main-content),
html.transitioning-forward::view-transition-new(sheets-column),
html.transitioning-forward::view-transition-new(difficulty-column) {
  animation-name: slideInFromTop;
}

/* Backward */
html.transitioning-backward::view-transition-old(main-content),
html.transitioning-backward::view-transition-old(sheets-column),
html.transitioning-backward::view-transition-old(difficulty-column) {
  animation-name: slideOutToRight;
}
html.transitioning-backward::view-transition-new(main-content),
html.transitioning-backward::view-transition-new(sheets-column),
html.transitioning-backward::view-transition-new(difficulty-column) {
  animation-name: slideInFromLeft;
}

/* Reset root animations to prevent interference (optional but safer) */
::view-transition-old(root),
::view-transition-new(root) {
    animation: none;
    animation-duration: 0s; /* Explicitly disable duration */
}

/* --- View Transition Definitions --- */

/* 1. Page Title Transition (Fade) */
::view-transition-old(page-title),
::view-transition-new(page-title) {
  animation-duration: 0.3s; /* Faster fade for title */
  animation-name: fade-out; /* Use simple fade for both old and new */
}
::view-transition-new(page-title) {
  animation-name: fade-in;
}

/* 2. Main Content Transition (Directional Slide) */

/* Default/Forward Animation (Slide Up/Down) */
html.transitioning-forward::view-transition-old(main-content),
html.transitioning-forward::view-transition-old(sheets-column),
html.transitioning-forward::view-transition-old(difficulty-column) {
  animation-name: slideOutToBottom;
}
html.transitioning-forward::view-transition-new(main-content),
html.transitioning-forward::view-transition-new(sheets-column),
html.transitioning-forward::view-transition-new(difficulty-column) {
  animation-name: slideInFromTop;
}

/* Backward Animation (Slide Left/Right) */
html.transitioning-backward::view-transition-old(main-content),
html.transitioning-backward::view-transition-old(sheets-column),
html.transitioning-backward::view-transition-old(difficulty-column) {
  animation-name: slideOutToRight;
}
html.transitioning-backward::view-transition-new(main-content),
html.transitioning-backward::view-transition-new(sheets-column),
html.transitioning-backward::view-transition-new(difficulty-column) {
  animation-name: slideInFromLeft;
}

/* Ensure root transition doesn't interfere */
::view-transition-old(root),
::view-transition-new(root) {
    animation: none;
}

/* --- Countdown Display Styling --- */
#countdownDisplay {
    position: fixed; /* Position relative to the viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: grid; /* Use grid to center the number */
    place-items: center; /* Center horizontally and vertically */
    background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent black overlay */
    color: white;
    font-family: 'Fredoka One', cursive;
    font-size: 20vw; /* Very large font size, relative to viewport width */
    font-weight: bold;
    text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.5);
    z-index: 50; /* Ensure it's above game elements but below modals */
    opacity: 1; /* Start visible */
    pointer-events: none; /* Allow clicks through */
    /* Add transition for smooth fade-out if desired */
    transition: opacity 0.5s ease-out;
}

#countdownDisplay.hidden {
    opacity: 0;
    /* Fade out when hidden class is added */
    pointer-events: none;
    display: grid !important; /* Override potential display:none from .hidden if we only want fade */
}

/* Optional: Animation for the number itself */
@keyframes countdownPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

#countdownDisplay.active { /* Apply pulse when class is added by JS */
    animation: countdownPulse 0.8s ease-in-out;
}

/* --- Custom Error Message Style --- */
.text-error-purple {
  color: #6a0dad !important; /* Vibrant purple */
  font-weight: bold;
  font-size: 1.4em; /* Increased size */
  background-color: transparent; /* Ensure no background override */
  margin-top: 15px;
  text-shadow: none; /* Removed text shadow */
}

/* Ensure it overrides styles within the dialog if necessary */
#connectionStatus .text-error-purple {
    color: #6a0dad !important; /* Reiterate color with more specificity */
}

/* Game Feedback Effects */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
  20%, 40%, 60%, 80% { transform: translateX(5px); }
}

@keyframes flash-bg {
  0%, 100% { background-color: transparent; }
  50% { background-color: rgba(76, 175, 80, 0.3); } /* Light green flash */
}

body.incorrect-answer-shake {
  animation: shake 0.5s ease-in-out;
}

body.correct-answer-flash {
  animation: flash-bg 0.5s ease-in-out;
}

/* --- End Game Feedback Effects --- */

/* Player List Effects */
@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

#opponentList .player-item.score-updated .player-score {
  animation: pulse 0.3s ease-in-out;
  font-weight: bold; /* Optional: make score bold during pulse */
}
/* --- End Player List Effects --- */

/* --- Toast Notification Styles --- */
#toastNotification {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    color: white;
    font-family: sans-serif;
    font-size: 1rem;
    z-index: 100; /* Ensure it's on top */
    opacity: 0;
    transition: opacity 0.4s ease-in-out, bottom 0.4s ease-in-out;
    pointer-events: none; /* Allow clicks through when hidden */
}

#toastNotification:not(.hidden) {
    opacity: 1;
    bottom: 30px; /* Slide up slightly when visible */
    pointer-events: auto; /* Allow interaction when visible */
}

#toastNotification.info {
    background-color: #2196F3; /* Blue */
}

#toastNotification.success {
    background-color: #4CAF50; /* Green */
}

#toastNotification.warn {
    background-color: #ff9800; /* Orange */
}

#toastNotification.error {
    background-color: #f44336; /* Red */
}

/* Optional: Add close button styles if implemented */
/*
#toastNotification .close-button {
    position: absolute;
    top: 5px;
    right: 10px;
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
}
*/
/* --- End Toast Notification Styles --- */

/* --- MODIFICATION START: Style #gameHeader Content --- */
#gameHeader {
    position: fixed; 
    top: 10%; 
    left: 10%; 
    right: 10%;
    width: 80%; 
    display: grid;
    grid-template-columns: minmax(150px, 1fr) auto minmax(100px, 0.5fr); 
    align-items: center;
    /* *** ADD SUFFICIENT LEFT PADDING TO AVOID STOP BUTTON *** */
    padding: 10px 15px 10px 120px; /* Increased left padding significantly */
    background-color: rgba(97, 74, 226, 0.2); 
    border-radius: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 10; 
    box-sizing: border-box;
    gap: 10px; 
}

#progressIndicator {
    grid-column: 2; 
    margin: 0 auto; 
    width: auto; 
    position: relative;
    top: auto; right: auto; 
    /* *** REVERT/ADJUST FONT & PADDING *** */
    font-size: 1.2rem; /* Restore or adjust size */
    padding: 8px 15px; /* Restore or adjust padding */
    /* Keep existing styles for background, color, radius etc. */
    background-color: rgba(97, 74, 226, 0.7);
    color: white;
    border-radius: 20px;
    font-weight: bold;
    font-family: 'Fredoka One', cursive;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    display: inline-flex; /* Use flex to align text and bar */
    align-items: center; /* Vertically center text and bar */
    gap: 8px; /* Add gap between text and bar */
}
#progressIndicator progress { 
    height: 12px; 
    vertical-align: middle; 
    appearance: none; 
    border: 1px solid rgba(0,0,0,0.2); /* Add subtle border */
    border-radius: 10px;
    overflow: hidden;
    background-color: rgba(255, 255, 255, 0.3); /* Ensure background color for track */
    width: 150px; /* Give it a minimum width */
}
/* Styling for the progress bar value (track) */
#progressIndicator progress::-webkit-progress-bar {
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 10px;
}
#progressIndicator progress::-webkit-progress-value {
    background-color: white;
    border-radius: 10px;
     /* Add a subtle transition */
    transition: width 0.3s ease-out;
}
#progressIndicator progress::-moz-progress-bar { /* Firefox */
     background-color: white;
     border-radius: 10px;
     transition: width 0.3s ease-out; /* Add transition for FF */
}


#gameHeaderLeft {
    grid-column: 1;
    /* ** CHANGE: Use Flexbox for horizontal layout ** */
    display: flex; 
    flex-direction: row; /* Arrange items horizontally */
    align-items: baseline; /* Align text baselines */
    justify-content: flex-start; /* Align to the start (left) */
    gap: 15px; /* Add space between items */
    text-align: left; /* Keep text left-aligned */
}

#scoreDisplay,
#timerDisplay,
#sheetTitleDisplay { 
    font-family: 'Fredoka One', cursive;
    font-size: 1.8rem; 
    color: #614ae2;
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.7);
    margin: 0; 
    padding: 0; 
    position: relative; 
    top: auto; right: auto; 
    z-index: auto; 
    line-height: 1; /* Adjust line height for flex alignment */
    white-space: nowrap; /* Prevent wrapping */
}

#sheetTitleDisplay {
    font-size: 1.4rem; 
    font-weight: normal;
    color: #4a3aab; 
    /* Optional: Add some margin if needed with flex gap */
    /* margin-left: 5px; */
}
/* --- MODIFICATION END --- */